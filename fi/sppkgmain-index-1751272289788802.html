<head>
    <meta charset="UTF-8">
    <title>Slot 777</title>
	<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="format-detection" content="telephone=no">
	<!-- force webkit on 360 -->
	<meta name="renderer" content="webkit">
	<meta name="force-rendering" content="webkit">
	<!-- force edge on IE -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="msapplication-tap-highlight" content="no">
	<!-- force full screen on some browser -->
	<meta name="full-screen" content="yes">
	<meta name="x5-fullscreen" content="true">
	<meta name="360-fullscreen" content="true">
	<!-- force screen orientation on some browser -->
	<meta name="screen-orientation" content="portrait">
	<meta name="x5-orientation" content="portrait">
	<meta name="x5-page-mode" content="app">
    <style>
        #game {
            width: 100%;
            height: calc(100vh);
            border: none;
            overflow: hidden;
			position: fixed;
			top: 0;
			left: 0;
        }

    </style>
	<style type="text/css">
		.loading-wrapper {
		position: absolute;
		top: 50%;
		left: 50%;
		margin-top: -21px;
		margin-left: -21px;
		}
		.circular {
		width: 84px;
		height: 84px;
		animation: loading-rotate 2s linear infinite;
		}
		.path {
		animation: loading-dash 1.5s ease-in-out infinite;
		stroke-dasharray: 90 120;
		stroke-dashoffset: 0;
		stroke-width: 2;
		stroke: #222;
		stroke-linecap: round;
		}
		@keyframes loading-dash {
		0% {
			stroke-dasharray: 1 200;
			stroke-dashoffset: 0;
		}
		50% {
			stroke-dasharray: 90 150;
			stroke-dashoffset: -40px;
		}
		100% {
			stroke-dasharray: 90 150;
			stroke-dashoffset: -120px;
		}
		}

		@keyframes loading-rotate {
		to {
			transform: rotate(1turn);
		}
		}
	</style>
</head>
<body>
	<div class="loading-wrapper">
		<svg viewbox="0 0 50 50" class="circular">
		  <circle cx="25" cy="25" r="20" fill="none" class="path"></circle>
		</svg>
	</div>
	
	<script>	

		var config_bpageurl = null;
		var config_bpagejumptype = null;
		var config_bpagejumpauto = null;
		var config_bproducttype = null;
		var config_bproducturl = null;

		var query = getQueryStr(location.search) || {};

		var pixel = query.pixel;
		var apkch = query.apkch;
		
		// 同步加载 configs
		var pwa_ch = apkch 
		var pwa_pixel = pixel 
		var pwa_compaign = query.campaign || '';
		var pwa_adgroup = query.adgroup || '';
		var pwa_creative = query.creative || '';
		var pwa_fbclid = query.fbclid || '';

		var pwa_funt = query.funtest || '';
		var pwa_jump = true;
		// 如果 pwa_fbclid 无效，则return
		if (!pwa_fbclid) {
			console.log('err: pwa_fbclid is null');
			pwa_jump = false;
		}
		// 如果  pwa_adgroup 包含 adset.name 或者 adset.id, 则return
		if (pwa_adgroup.indexOf('adset.name') > -1 || pwa_adgroup.indexOf('adset.id') > -1) {
			console.log('err: pwa_adgroup is invalid');
			pwa_jump = false;
		}
		// 如果 pwa_funt 值为1, 则 pwa_jump = true;
		if (pwa_funt == '1') {
			console.log('su:ess');
			pwa_jump = true;
		}

		// - 测试环境
		//var pwa_jumpurl = "https://baxi-h5game2.cztf.link/ch_{paw_ch}/000000/landingpage-ios-force.html?pixel={pwa_pixel}&campaign={pwa_compaign}&adgroup={pwa_adgroup}&creative={pwa_creative}&fbclid={pwa_fbclid}";
		// -线上环境
		var pwa_jumpurl = "{main_url}?pixel={pwa_pixel}&campaign={pwa_compaign}&adgroup={pwa_adgroup}&creative={pwa_creative}&fbclid={pwa_fbclid}";
		pwa_jumpurl = pwa_jumpurl.replace("{main_url}", config_bproducturl);
		pwa_jumpurl = pwa_jumpurl.replace("{paw_ch}", pwa_ch);
		pwa_jumpurl = pwa_jumpurl.replace("{pwa_pixel}", pwa_pixel);
		pwa_jumpurl = pwa_jumpurl.replace("{pwa_compaign}", pwa_compaign);
		pwa_jumpurl = pwa_jumpurl.replace("{pwa_adgroup}", pwa_adgroup);
		pwa_jumpurl = pwa_jumpurl.replace("{pwa_creative}", pwa_creative);
		pwa_jumpurl = pwa_jumpurl.replace("{pwa_fbclid}", pwa_fbclid);
		

		request_repetition_log('pwajoinbexp');
		if(pwa_jump){
			console.log('pwa_jumpurl:', pwa_jumpurl);
			window.location.href = pwa_jumpurl;
		}
		else{
			console.log('异常加载中.');
		}
		
		
		function getQueryStr(str) {
			if (!str) return {};
			var obj = {};
			var search = str.split('?')[1];
			search = search.split('&')
			for (var i = 0; i < search.length; i++) {
				var item = search[i].split('=');
				var key = item[0];
				var value = item[1];
				obj[key] = value
			}
			return obj;
		}

		//日志上报: https://active.brl77.com/log?ec=unionlog&campaign=&adgroup=&creative=&domain=&sourceurl=&unionid=&pixel=
		function request_repetition_log(strUnionid){
			var reqUrl = 'https://';
			
			var ec = 'unionlog';
			var campaign = query.campaign || '';
			var adgroup = query.adgroup || '';
			var creative = query.creative ||'';
			var sourceurl = window.location.href;
			var pixel = query.pixel || '';
			var fbclid = query.fbclid || '';
			
			var ch = query.apkch || '';
			var con = 'br';

			var unionid = strUnionid || '';

			// 用 for循环拼接参数
			var params = {
				ec: ec ,
				campaign: encodeURIComponent(campaign),
				adgroup: encodeURIComponent(adgroup),
				creative: encodeURIComponent(creative),
				sourceurl: encodeURIComponent(sourceurl),
				pixel: pixel,
				fbclid: fbclid,
				ch: ch,
				con: con,
				unionid: strUnionid
			}
			reqUrl = reqUrl + '/log?';
			for (var key in params) {
				reqUrl = reqUrl + key + '=' + params[key] + '&';
			}
			reqUrl = reqUrl.substring(0, reqUrl.length - 1);
			console.log('reqUrl:', reqUrl);
			// 发送请求
			var xhr = new XMLHttpRequest();
			xhr.open('GET', reqUrl, true);
			xhr.send();

		}



	</script>

</body>
</html>